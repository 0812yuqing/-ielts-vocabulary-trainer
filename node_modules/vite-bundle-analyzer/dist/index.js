"use strict";let e;Object.defineProperty(exports,"__esModule",{value:!0});var t,r=require("path"),n=require("os"),i=require("child_process"),o=require("stream"),s=require("http"),l=require("net"),u=require("zlib"),a=require("util"),c=require("fs"),d={exports:{}};Object.defineProperty(d.exports,"__esModule",{value:!0});const{round:f,floor:p,max:h}=Math,m=e=>{let[,t]=/([a-f\d]{3,6})/i.exec(e)||[],r=t?t.length:0;if(3===r)t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2];else if(6!==r)return[0,0,0];let n=parseInt(t,16);return[n>>16&255,n>>8&255,255&n]},g=(e,t,r)=>e===t&&t===r?e<8?16:e>248?231:f((e-8)/247*24)+232:16+36*f(e/51)+6*f(t/51)+f(r/51),y=e=>{let t,r,n,i,o,s;return e<8?30+e:e<16?e-8+90:(e>=232?t=r=n=(10*(e-232)+8)/255:(s=(e-=16)%36,t=p(e/36)/5,r=p(s/6)/5,n=s%6/5),0==(i=2*h(t,r,n))?30:(o=30+(f(n)<<2|f(r)<<1|f(t)),2===i?o+60:o))},w=(e,t,r)=>y(g(e,t,r)),S=(e=>{let t=e=>!!u.find(t=>e.test(t)),r=globalThis,n=r.Deno,i=null!=n,o=r.process||n||{},s=o.stdout,l="win32"===(i?n.build.os:o.platform),u=o.argv||o.args||[],a=o.env||{},c=-1;if(i)try{a=a.toObject()}catch(e){c=0}let d="FORCE_COLOR",f=a[d],p=parseInt(f),h="false"===f?0:isNaN(p)?3:p,m="NO_COLOR"in a||0===h||t(/^-{1,2}(no-color|color=(false|never))$/),g=d in a&&h||t(/^-{1,2}color=?(true|always)?$/),y=(a.NEXT_RUNTIME||"").indexOf("edge")>-1||"PM2_HOME"in a&&"pm_id"in a||(i?n.isatty(1):s&&"isTTY"in s);return m?0:(c<0&&(c=((e,t,r)=>{let{TERM:n,COLORTERM:i}=e;return"TF_BUILD"in e?1:"TEAMCITY_VERSION"in e?2:"CI"in e?["GITHUB_ACTIONS","GITEA_ACTIONS"].some(t=>t in e)?3:1:!t||/-mono|dumb/i.test(n)?0:r||"truecolor"===i||"24bit"===i||"xterm-kitty"===n?3:/-256(colou?r)?$/i.test(n)?2:/^screen|^tmux|^xterm|^vt[1-5][0-9]([0-9])?|^ansi|color|cygwin|linux|mintty|rxvt/i.test(n)?1:3})(a,y,l)),g&&0===c?3:c)})(),b=S>0,x={open:"",close:""},z=b?(e,t)=>({open:`[${e}m`,close:`[${t}m`}):()=>x,_=e=>(t,r,n)=>e(g(t,r,n)),v=e=>t=>{let[r,n,i]=m(t);return e(r,n,i)};let O=e=>z(`38;5;${e}`,39),$=e=>z(`48;5;${e}`,49),M=(e,t,r)=>z(`38;2;${e};${t};${r}`,39),k=(e,t,r)=>z(`48;2;${e};${t};${r}`,49);1===S?(O=e=>z(y(e),39),$=e=>z(y(e)+10,49),M=(e,t,r)=>z(w(e,t,r),39),k=(e,t,r)=>z(w(e,t,r)+10,49)):2===S&&(M=_(O),k=_($));let E,C,j={ansi256:O,bgAnsi256:$,fg:O,bg:$,rgb:M,bgRgb:k,hex:v(M),bgHex:v(k),visible:x,reset:z(0,0),inverse:z(7,27),hidden:z(8,28),bold:z(1,22),dim:z(2,22),italic:z(3,23),underline:z(4,24),strikethrough:z(9,29),strike:z(9,29),grey:z(90,39),gray:z(90,39),bgGrey:z(100,49),bgGray:z(100,49)},I="Bright",P=30;for(E of["black","red","green","yellow","blue","magenta","cyan","white"])C="bg"+E[0].toUpperCase()+E.slice(1),j[E]=z(P,39),j[E+I]=z(P+60,39),j[C]=z(P+10,49),j[C+I]=z(P+70,49),P++;const{defineProperty:B,defineProperties:R,setPrototypeOf:A}=Object,N=/[Â›][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,T=/(\r?\n)/g,D={},L=({_p:t},{open:r,close:n})=>{let i=(e,...t)=>{if(!e)return"";let r=i._p,{_a:n,_b:o}=r,s=null!=e.raw?String.raw(e,...t):""+e;if(s.includes("\x1b"))for(;null!=r;){let e=r.close,t=e.length;if(t){let n,i=0,o="";for(;~(n=s.indexOf(e,i));)o+=s.slice(i,n)+r.open,i=n+t;i&&(s=o+s.slice(i))}r=r._p}return s.includes("\n")&&(s=s.replace(T,o+"$1"+n)),n+s+o},o=r,s=n;return null!=t&&(o=t._a+r,s=n+t._b),A(i,e),i._p={open:r,close:n,_a:o,_b:s,_p:t},i.open=o,i.close=s,i},F=function(){let t=e=>""+e;return t.isSupported=()=>b,t.strip=e=>e.replace(N,""),t.extend=r=>{for(let e in r){let t=r[e],n=typeof t,i="string"===n?M(...m(t)):t;D[e]="function"===n?{get(){return(...e)=>L(this,t(...e))}}:{get(){let t=L(this,i);return B(this,e,{value:t}),t}}}A(t,e=R({},D))},t.extend(j),t},q=new F;d.exports=q,d.exports.Ansis=F;var U=(t=d.exports)&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;const W=c.promises,G=new TextEncoder,J=new TextDecoder,H=a.promisify(u.gzip),K={level:u.constants.Z_DEFAULT_LEVEL},Y=V(r.join(__dirname,"client")),Z=V(r.join(Y,"assets"));function V(e){return/^\\\\\?\\/.test(e)?e:e.replace(/\\/g,"/")}function X(e){return"string"==typeof e?G.encode(e):e}async function Q(e){let t=await Promise.all((await W.readdir(e)).map(t=>r.join(e,t))),n=0,i=[];for(;n!==t.length;){let e=t[n],o=await W.stat(e);if(o.isDirectory()){let n=await W.readdir(e);t.push(...n.map(t=>r.join(e,t)))}o.isFile()&&i.push(e),n++}return i}const ee=process.env.DEBUG||process.env.ANALYZE_DEBUG?(...e)=>{console.log(U.hex("#5B45DE")("[vite:bundle-analyzer]"),...e)}:()=>{};function et(e){let t="head"===e.injectTo?/([ \t]*)<\/head>/i:/([ \t]*)<\/body>/i;e.descriptors=Array.isArray(e.descriptors)?e.descriptors:[e.descriptors];let r=e.descriptors.map(e=>e.attrs&&e.attrs.length>0?`<${e.kind} ${e.attrs.join(" ")}>${e.text}</${e.kind}>`:`<${e.kind}>${e.text}</${e.kind}>`);return e.html.replace(t,e=>`${r.join("\n")}${e}`)}async function er(e,t){let n=await Q(Z),i=(await Promise.all(n.map(async e=>({fileType:r.extname(e).replace(".",""),content:await W.readFile(e,"utf8")})))).filter(e=>["js","css"].includes(e.fileType)),o=await W.readFile(r.join(Y,"index.html"),"utf8");return o=et({html:o=(o=(o=o.replace(/<script\b[^>]*>[\s\S]*?<\/script>/gi,"")).replace(/<link\b[^>]*rel="stylesheet"[^>]*>/gi,"")).replace(/<title>(.*?)<\/title>/,`<title>${t.title}</title>`),injectTo:"head",descriptors:i.map(({fileType:e,content:t})=>({kind:"js"===e?"script":"style",text:t,attrs:"js"===e?['type="module"']:[]}))}),o=et({html:o,injectTo:"body",descriptors:{kind:"script",text:function(e,t){let{stringify:r}=JSON;return`var defaultSizes=${r(t)},analyzeModule=${r(e)};`}(e,t.mode)}})}async function en(e){let t=()=>Math.floor(64512*Math.random())+1024,r=async e=>new Promise(t=>{let r=l.createServer();r.once("error",e=>{"EADDRINUSE"===e.code?t(!1):t(!0)}),r.once("listening",()=>{r.close(()=>{t(!0)})}),r.listen(e,"localhost")});if(0===e){let e=!1,n=0;for(;!e;)n=t(),e=await r(n);return n}let n=await r(e);if(n)return e;{let t=e+1;for(;;){if(n=await r(t))return t;t++}}}async function ei(e=0){let t=s.createServer(),r=await en(e);return t.listen(r,()=>{console.log("server run on ",U.hex("#5B45DE")(`http://localhost:${r}`))}),{setup:e=>{t.on("request",function(t,r){"/"===t.url&&(r.setHeader("Content-Type","text/html; charset=utf8;"),r.setHeader("Content-Encoding","gzip"),e.arena.rs.pipe(u.createGzip()).pipe(r),e.arena.refresh())})},get port(){return r}}}const eo=["pnpm-workspace.yaml","lerna.json"];function es(e,t=function e(t,n=t){if(function(e){let t=r.join(e,"package.json");return c.existsSync(t)}(t))return t;let i=r.dirname(t);return i&&i!==t?e(i,n):n}(e)){if(eo.some(t=>c.existsSync(r.join(e,t)))||function(e){let t=r.join(e,"package.json");if(!function(e){if(!function(e){try{return c.statSync(e,{throwIfNoEntry:!1})}catch{}}(e))return!1;try{return c.accessSync(e,c.constants.R_OK),!0}catch{return!1}}(t))return!1;try{return!!(JSON.parse(c.readFileSync(t,"utf-8"))||{}).workspaces}catch{return!1}}(e))return e;let n=r.dirname(e);return n&&n!==e?es(n,t):t}class el{kind;meta;filename;children;groups;isEndOfPath;constructor(e){this.kind=e?.kind||"stat",this.meta=e?.meta||{},this.filename=e?.filename||"",this.children=new Map,this.groups=[],this.isEndOfPath=!1}}class eu{root;constructor(e){this.root=new el(e)}insert(e,t){let r=this.root,n=e.split("/").filter(Boolean),i="";for(let e of n)i=i?`${i}/${e}`:e,r.children.has(e)||r.children.set(e,new el({...t})),(r=r.children.get(e)).filename=i;r.isEndOfPath=!0}mergePrefixSingleDirectory(e=this.root){for(let[t,r]of e.children.entries()){if(r.isEndOfPath)break;if(r.children.size>1){this.mergePrefixSingleDirectory(r);continue}for(let[n,i]of(e.children.delete(t),r.children.entries()))e.children.set(`${t}/${n}`,i),i.isEndOfPath||this.mergePrefixSingleDirectory(i)}}walk(e,t){if(e.children.size){for(let[r,n]of e.children.entries()){let i={...n.meta,label:r,groups:n.groups,filename:n.filename};if(n.isEndOfPath&&delete i.groups,t(i,e),this.walk(n,t),i.groups&&i.groups.length)switch(e.kind){case"stat":i.statSize=i.groups.reduce((e,t)=>e+t.statSize,0);break;case"source":{let e=i.groups.reduce((e,t)=>(e.parsedSize+=t.parsedSize,e.gzipSize+=t.gzipSize,e),{parsedSize:0,gzipSize:0});Object.assign(i,e)}}}e.children.clear()}}}const ea="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ec=new Uint8Array(64),ed=new Uint8Array(128);for(let e=0;e<ea.length;e++){let t=ea.charCodeAt(e);ec[e]=t,ed[t]=e}const ef="undefined"!=typeof TextDecoder?new TextDecoder:"undefined"!=typeof Buffer?{decode:e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString()}:{decode(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}};function ep(e,t,r,n){let i=0,o=0,s=0;do i|=(31&(s=ed[e.charCodeAt(t++)]))<<o,o+=5;while(32&s);let l=1&i;return i>>>=1,l&&(i=-2147483648|-i),r[n]+=i,t}function eh(e,t,r){return!(t>=r)&&44!==e.charCodeAt(t)}function em(e,t){return e[0]-t[0]}function eg(e,t,r,n,i){let o=n[i],s=o-r[i];r[i]=o,s=s<0?-s<<1|1:s<<1;do{let r=31&s;(s>>>=5)>0&&(r|=32),e[t++]=ec[r]}while(s>0);return t}const ey=/^[\w+.-]+:\/\//,ew=/^([\w+.-]+:)\/\/([^@/#?]*@)?([^:/#?]*)(:\d+)?(\/[^#?]*)?(\?[^#]*)?(#.*)?/,eS=/^file:(?:\/\/((?![a-z]:)[^/#?]*)?)?(\/?[^#?]*)(\?[^#]*)?(#.*)?/i;function eb(e){return e.startsWith("/")}function ex(e){return/^[.?#]/.test(e)}function ez(e){let t=ew.exec(e);return e_(t[1],t[2]||"",t[3],t[4]||"",t[5]||"/",t[6]||"",t[7]||"")}function e_(e,t,r,n,i,o,s){return{scheme:e,user:t,host:r,port:n,path:i,query:o,hash:s,type:7}}function ev(e){if(e.startsWith("//")){let t=ez("http:"+e);return t.scheme="",t.type=6,t}if(eb(e)){let t=ez("http://foo.com"+e);return t.scheme="",t.host="",t.type=5,t}if(e.startsWith("file:"))return function(e){let t=eS.exec(e),r=t[2];return e_("file:","",t[1]||"","",eb(r)?r:"/"+r,t[3]||"",t[4]||"")}(e);if(ey.test(e))return ez(e);let t=ez("http://foo.com/"+e);return t.scheme="",t.host="",t.type=e?e.startsWith("?")?3:e.startsWith("#")?2:4:1,t}function eO(e,t){let r=t<=4,n=e.path.split("/"),i=1,o=0,s=!1;for(let e=1;e<n.length;e++){let t=n[e];if(!t){s=!0;continue}if(s=!1,"."!==t){if(".."===t){o?(s=!0,o--,i--):r&&(n[i++]=t);continue}n[i++]=t,o++}}let l="";for(let e=1;e<i;e++)l+="/"+n[e];l&&(!s||l.endsWith("/.."))||(l+="/"),e.path=l}function e$(e,t){return t&&!t.endsWith("/")&&(t+="/"),function(e,t){if(!e&&!t)return"";let r=ev(e),n=r.type;if(t&&7!==n){let e=ev(t),i=e.type;switch(n){case 1:r.hash=e.hash;case 2:r.query=e.query;case 3:case 4:eO(e,e.type),"/"===r.path?r.path=e.path:r.path=function(e){if(e.endsWith("/.."))return e;let t=e.lastIndexOf("/");return e.slice(0,t+1)}(e.path)+r.path;case 5:r.user=e.user,r.host=e.host,r.port=e.port;case 6:r.scheme=e.scheme}i>n&&(n=i)}eO(r,n);let i=r.query+r.hash;switch(n){case 2:case 3:return i;case 4:{let n=r.path.slice(1);if(!n)return i||".";if(ex(t||e)&&!ex(n))return"./"+n+i;return n+i}case 5:return r.path+i;default:return r.scheme+"//"+r.user+r.host+r.port+r.path+i}}(e,t)}function eM(e,t){for(let r=t;r<e.length;r++)if(!function(e){for(let t=1;t<e.length;t++)if(e[t][0]<e[t-1][0])return!1;return!0}(e[r]))return r;return e.length}function ek(e,t){return e[0]-t[0]}let eE=!1;function eC(e,t,r){for(let n=r+1;n<e.length&&e[n][0]===t;r=n++);return r}function ej(e,t,r){for(let n=r-1;n>=0&&e[n][0]===t;r=n--);return r}function eI(){return{lastKey:-1,lastNeedle:-1,lastIndex:-1}}function eP(e,t,r,n){let{lastKey:i,lastNeedle:o,lastIndex:s}=r,l=0,u=e.length-1;if(n===i){if(t===o)return eE=-1!==s&&e[s][0]===t,s;t>=o?l=-1===s?0:s:u=s}return r.lastKey=n,r.lastNeedle=t,r.lastIndex=function(e,t,r,n){for(;r<=n;){let i=r+(n-r>>1),o=e[i][0]-t;if(0===o)return eE=!0,i;o<0?r=i+1:n=i-1}return eE=!1,r-1}(e,t,l,u)}function eB(){return{__proto__:null}}const eR=function(e,t){let r=eA(e);if(!("sections"in r))return new eL(r,t);let n=[],i=[],o=[],s=[],l=[];return function e(t,r,n,i,o,s,l,u,a,c,d){let{sections:f}=t;for(let t=0;t<f.length;t++){let{map:p,offset:h}=f[t],m=c,g=d;if(t+1<f.length){let e=f[t+1].offset;(m=Math.min(c,u+e.line))===c?g=Math.min(d,a+e.column):m<c&&(g=a+e.column)}!function(t,r,n,i,o,s,l,u,a,c,d){let f=eA(t);if("sections"in f)return e(...arguments);let p=new eL(f,r),h=i.length,m=s.length,g=eF(p),{resolvedSources:y,sourcesContent:w,ignoreList:S}=p;if(eN(i,y),eN(s,p.names),w)eN(o,w);else for(let e=0;e<y.length;e++)o.push(null);if(S)for(let e=0;e<S.length;e++)l.push(S[e]+h);for(let e=0;e<g.length;e++){let t=u+e;if(t>c)return;let r=function(e,t){for(let r=e.length;r<=t;r++)e[r]=[];return e[t]}(n,t),i=0===e?a:0,o=g[e];for(let e=0;e<o.length;e++){let n=o[e],s=i+n[0];if(t===c&&s>=d)return;if(1===n.length){r.push([s]);continue}let l=h+n[1],u=n[2],a=n[3];r.push(4===n.length?[s,l,u,a]:[s,l,u,a,m+n[4]])}}}(p,r,n,i,o,s,l,u+h.line,a+h.column,m,g)}}(r,t,n,i,o,s,l,0,0,1/0,1/0),function(e,t){var r;let n=new eL((r=[],{version:e.version,file:e.file,names:e.names,sourceRoot:e.sourceRoot,sources:e.sources,sourcesContent:e.sourcesContent,mappings:r,ignoreList:e.ignoreList||e.x_google_ignoreList}),void 0);return n._decoded=e.mappings,n}({version:3,file:r.file,names:s,sources:i,sourcesContent:o,mappings:n,ignoreList:l})};function eA(e){return"string"==typeof e?JSON.parse(e):e}function eN(e,t){for(let r=0;r<t.length;r++)e.push(t[r])}const eT="`line` must be greater than 0 (lines start at line 1)",eD="`column` must be greater than or equal to 0 (columns start at column 0)";class eL{constructor(e,t){let r="string"==typeof e;if(!r&&e._decodedMemo)return e;let n=r?JSON.parse(e):e,{version:i,file:o,names:s,sourceRoot:l,sources:u,sourcesContent:a}=n;this.version=i,this.file=o,this.names=s||[],this.sourceRoot=l,this.sources=u,this.sourcesContent=a,this.ignoreList=n.ignoreList||n.x_google_ignoreList||void 0;let c=e$(l||"",function(e){if(!e)return"";let t=e.lastIndexOf("/");return e.slice(0,t+1)}(t));this.resolvedSources=u.map(e=>e$(e||"",c));let{mappings:d}=n;"string"==typeof d?(this._encoded=d,this._decoded=void 0):(this._encoded=void 0,this._decoded=function(e,t){let r=eM(e,0);if(r===e.length)return e;t||(e=e.slice());for(let i=r;i<e.length;i=eM(e,i+1)){var n;e[i]=(n=e[i],t||(n=n.slice()),n.sort(ek))}return e}(d,r)),this._decodedMemo=eI(),this._bySources=void 0,this._bySourceMemos=void 0}}function eF(e){return e._decoded||(e._decoded=function(e){let t=new Int32Array(5),r=[],n=0;do{let i=function(e,t){let r=e.indexOf(";",t);return -1===r?e.length:r}(e,n),o=[],s=!0,l=0;t[0]=0;for(let r=n;r<i;r++){let n;r=ep(e,r,t,0);let u=t[0];u<l&&(s=!1),l=u,eh(e,r,i)?(r=ep(e,r,t,1),r=ep(e,r,t,2),r=ep(e,r,t,3),eh(e,r,i)?(r=ep(e,r,t,4),n=[u,t[1],t[2],t[3],t[4]]):n=[u,t[1],t[2],t[3]]):n=[u],o.push(n)}s||function(e){e.sort(em)}(o),r.push(o),n=i+1}while(n<=e.length);return r}(e._encoded))}function eq(e,t,r,n){return{source:e,line:t,column:r,name:n}}function eU(e,t){return{line:e,column:t}}function eW(e,t,r,n,i){let o=eP(e,n,t,r);return(eE?o=(-1===i?eC:ej)(e,n,o):-1===i&&o++,-1===o||o===e.length)?-1:o}function eG(e,t,r,n,i,o){if(--r<0)throw Error(eT);if(n<0)throw Error(eD);let{sources:s,resolvedSources:l}=e,u=s.indexOf(t);if(-1===u&&(u=l.indexOf(t)),-1===u)return o?[]:eU(null,null);let a=(e._bySources||(e._bySources=function(e,t){let r=t.map(eB);for(let n=0;n<e.length;n++){let i=e[n];for(let e=0;e<i.length;e++){let o=i[e];if(1===o.length)continue;let s=o[1],l=o[2],u=o[3],a=r[s],c=a[l]||(a[l]=[]),d=t[s],f=eC(c,u,eP(c,u,d,l));d.lastIndex=++f,function(e,t,r){for(let r=e.length;r>t;r--)e[r]=e[r-1];e[t]=r}(c,f,[u,n,o[0]])}}return r}(eF(e),e._bySourceMemos=s.map(eI))))[u][r];if(null==a)return o?[]:eU(null,null);let c=e._bySourceMemos[u];if(o)return function(e,t,r,n,i){let o=eW(e,t,r,n,1);if(!eE&&-1===i&&o++,-1===o||o===e.length)return[];let s=eE?n:e[o][0];eE||(o=ej(e,s,o));let l=eC(e,s,o),u=[];for(;o<=l;o++){let t=e[o];u.push(eU(t[1]+1,t[2]))}return u}(a,c,r,n,i);let d=eW(a,c,r,n,i);if(-1===d)return eU(null,null);let f=a[d];return eU(f[1]+1,f[2])}class eJ{constructor(e,t){let r=this._map=new eR(e,t);this.file=r.file,this.names=r.names,this.sourceRoot=r.sourceRoot,this.sources=r.resolvedSources,this.sourcesContent=r.sourcesContent,this.version=r.version}static fromSourceMap(e,t){return e.toDecodedMap?new eJ(e.toDecodedMap(),t):new eJ(e.toJSON(),t)}get mappings(){var e,t;return null!==(t=(e=this._map)._encoded)&&void 0!==t?t:e._encoded=function(e){let t=new Int32Array(5),r=new Uint8Array(16384),n=r.subarray(0,16348),i=0,o="";for(let s=0;s<e.length;s++){let l=e[s];if(s>0&&(16384===i&&(o+=ef.decode(r),i=0),r[i++]=59),0!==l.length){t[0]=0;for(let e=0;e<l.length;e++){let s=l[e];i>16348&&(o+=ef.decode(n),r.copyWithin(0,16348,i),i-=16348),e>0&&(r[i++]=44),i=eg(r,i,t,s,0),1!==s.length&&(i=eg(r,i,t,s,1),i=eg(r,i,t,s,2),i=eg(r,i,t,s,3),4!==s.length&&(i=eg(r,i,t,s,4)))}}}return o+ef.decode(r.subarray(0,i))}(e._decoded)}originalPositionFor(e){return function(e,t){let{line:r,column:n,bias:i}=t;if(--r<0)throw Error(eT);if(n<0)throw Error(eD);let o=eF(e);if(r>=o.length)return eq(null,null,null,null);let s=o[r],l=eW(s,e._decodedMemo,r,n,i||1);if(-1===l)return eq(null,null,null,null);let u=s[l];if(1===u.length)return eq(null,null,null,null);let{names:a,resolvedSources:c}=e;return eq(c[u[1]],u[2]+1,u[3],5===u.length?a[u[4]]:null)}(this._map,e)}generatedPositionFor(e){return function(e,t){let{source:r,line:n,column:i,bias:o}=t;return eG(e,r,n,i,o||1,!1)}(this._map,e)}allGeneratedPositionsFor(e){return function(e,t){let{source:r,line:n,column:i,bias:o}=t;return eG(e,r,n,i,o||-1,!0)}(this._map,e)}hasContentsOfAllSources(){if(!this.sourcesContent||this.sourcesContent.length!==this.sources.length)return!1;for(let e of this.sourcesContent)if(null==e)return!1;return!0}sourceContentFor(e,t){let r=function(e,t){let{sourcesContent:r}=e;if(null==r)return null;let n=function(e,t){let{sources:r,resolvedSources:n}=e,i=r.indexOf(t);return -1===i&&(i=n.indexOf(t)),i}(e,t);return -1===n?null:r[n]}(this._map,e);if(null!=r)return r;if(t)return null;throw Error(`"${e}" is not in the SourceMap.`)}eachMapping(e,t){!function(e,t){let r=eF(e),{names:n,resolvedSources:i}=e;for(let e=0;e<r.length;e++){let o=r[e];for(let r=0;r<o.length;r++){let s=o[r],l=e+1,u=s[0],a=null,c=null,d=null,f=null;1!==s.length&&(a=i[s[1]],c=s[2]+1,d=s[3]),5===s.length&&(f=n[s[4]]),t({generatedLine:l,generatedColumn:u,source:a,originalLine:c,originalColumn:d,name:f})}}}(this._map,t?e.bind(t):e)}destroy(){}}class eH extends eJ{constructor(e){super(JSON.parse(e),"")}}const eK=[".mjs",".js",".cjs",".ts",".tsx",".vue",".svelte",".md",".mdx"],eY=process.cwd();function eZ(e,t=eY){let n=function(e,t=eY){return(e=V(e)).replace(t,"").replace(/\0/,"")}(e,t);return r.isAbsolute(n)?n.replace("/",""):n}function eV(e,t,r){ee(`[${e}]: ${U.yellow(t)} find ${U.bold(U.green(r+""))} relative modules.`)}class eX{originalId;filename;label;parsedSize;mapSize;statSize;gzipSize;source;stats;imports;isAsset;isEntry;constructor(e){this.originalId=e,this.filename=e,this.label=e,this.parsedSize=0,this.statSize=0,this.gzipSize=0,this.mapSize=0,this.source=[],this.stats=[],this.imports=new Set,this.isAsset=!0,this.isEntry=!1}addImports(...e){e.forEach(e=>this.imports.add(e))}async setup(e,t,n,i){let{imports:o,dynamicImports:s,map:l,moduleIds:u}=e;this.addImports(...o,...s),this.mapSize=l.length,this.isEntry=e.isEntry;let a=u.length?u.reduce((e,n)=>{let i=t.getModuleInfo(n);return i&&i.code&&(eK.includes(r.extname(i.id))||i.id.startsWith("\0"))&&e.push({id:i.id,code:i.code}),e},[]):function(e){let t=new eH(e),r=t.sources.reduce((e,r)=>{if(r){let n=t.sourceContentFor(r,!0);n&&e.push({id:r,code:n})}return e},[]);return t.destroy(),r}(l),c=new eu({meta:{statSize:0}}),d=new eu({kind:"source",meta:{gzipSize:0,parsedSize:0}});for(let e of a){"."===e.id[0]&&(e.id=r.resolve(i,e.id));let t=X(e.code).byteLength;this.statSize+=t,c.insert(eZ(e.id,i),{kind:"stat",meta:{statSize:t}})}eV("stats",this.originalId,a.length);let{grouped:f,files:p}=function(e,t,r){let n=new eH(t),i={},o=new Set,s=1,l=0,u="string"==typeof e?e:J.decode(e);for(let e=0;e<u.length;e++,l++){let{source:t}=n.originalPositionFor({line:s,column:l});if(null!=t){let n=r(t),s=u[e];n in i||(i[n]=""),i[n]+=s,o.add(n)}"\n"===u[e]&&(s+=1,l=-1)}return n.destroy(),{grouped:i,files:o}}(e.code,l,e=>{let t=r.relative(i,e);return r.join(i,t)});for(let t in p.size||(f[this.originalId]=e.code,p.add(this.originalId)),f){if(!eK.includes(r.extname(t)))continue;let e=X(f[t]),{byteLength:o}=await n(e),s=e.byteLength;d.insert(eZ(t,i),{kind:"source",meta:{gzipSize:o,parsedSize:s}})}for(let e of(eV("source",this.originalId,p.size),c.mergePrefixSingleDirectory(),c.walk(c.root,(e,t)=>t.groups.push(e)),d.mergePrefixSingleDirectory(),d.walk(d.root,(e,t)=>t.groups.push(e)),this.stats=c.root.groups,this.source=d.root.groups,this.source))this.gzipSize+=e.gzipSize,this.parsedSize+=e.parsedSize}}class eQ{compress;modules;workspaceRoot;pluginContext;chunks;constructor(e){this.compress=function(e={}){return e=Object.assign(K,e),t=>H(t,e)}(e),this.modules=[],this.pluginContext=null,this.chunks={},this.workspaceRoot=process.cwd()}installPluginContext(e){this.pluginContext||(this.pluginContext=e)}setupRollupChunks(e){this.chunks=e}async addModule(e,t){let r=function(e,t,r){let n={},i="chunk"===e.type;return n.code=X(i?e.code:e.source),n.map=r?function(e,t,r){if(t in r)return r[t].source;throw Error(`[analyzer error]: Missing sourcemap for ${e}.`)}(e.fileName,r,t):i?e.map?.toString():"",n.imports=i?e.imports:[],n.dynamicImports=i?e.dynamicImports:[],n.moduleIds=i?Object.keys(e.modules):[],n.filename=e.fileName,n.isEntry=!!i&&e.isEntry,n}(e,this.chunks,t),n=new eX(r.filename);await n.setup(r,this.pluginContext,this.compress,this.workspaceRoot),this.modules.push(n)}processModule(){return this.modules.map(e=>{let{originalId:t,imports:r,...n}=e;return{...n,imports:[...r]}})}}const e0=!!process.env.CI,e1={analyzerMode:"server",defaultSizes:"stat",summary:!0},e2=e=>U.dim(U.bold(e+"")),e3=e=>e2(function(e){if(!e)return"0 Bytes";let t=parseInt(`${Math.floor(Math.log(e)/Math.log(1024))}`);return(e/(1<<10*t)).toFixed(2)+" "+["Bytes","KB","MB","GB","TB"][t]}(e)),e4=e=>{let t=e.length,r=e.reduce((e,t)=>(e.gzip+=t.gzipSize,e.parsed+=t.parsedSize,e.map+=t.mapSize,e),{gzip:0,parsed:0,map:0}),n=[r.gzip&&`gzip: ${e3(r.gzip)}`,r.map&&`map: ${e3(r.map)}`].filter(Boolean).join(" | ");return`${e2(t)} chunks of ${e3(r.parsed)} ${n?`(${n})`:""}`};function e5(e){let t,s,l;let{reportTitle:u="vite-bundle-analyzer"}=e={...e1,...e},a=new eQ(e?.gzipOptions),c={previousSourcemapOption:!1,hasSetSourcemapOption:!1,analyzerModule:a},d=process.cwd(),f=!0,p=process.cwd(),h="server"===e.analyzerMode||"static"===e.analyzerMode,m="json"===e.analyzerMode||"static"===e.analyzerMode,g=(l=!1,{rs:new o.Readable,into(e){l||(this.rs.push(e),this.rs.push(null),s||(s=X(e)),l=!0)},refresh(){l=!1,this.rs=new o.Readable,this.into(s)}});return{name:"vite-bundle-anlyzer",apply:"build",enforce:"post",api:{store:c},configResolved(n){if(d=r.resolve(n.root,n.build.outDir??""),t=n.logger,p=es(n.root),a.workspaceRoot=p,e.summary){let e=n.plugins.find(e=>"vite:reporter"===e.name);if(f=!!e?.writeBundle,e?.writeBundle){let r="function"==typeof e.writeBundle?e.writeBundle:e.writeBundle?.handler,n=async function(...e){await r?.apply(this,e),t.info(e4(a.modules))};"function"!=typeof e.writeBundle?e.writeBundle.handler=n:e.writeBundle=n}}c.hasSetSourcemapOption||(c.hasSetSourcemapOption=!0,n.build?.sourcemap&&(c.previousSourcemapOption="boolean"==typeof n.build.sourcemap?n.build.sourcemap:"hidden"===n.build.sourcemap),"boolean"==typeof n.build.sourcemap&&n.build.sourcemap?n.build.sourcemap=!0:n.build.sourcemap="hidden",ee(`plugin status is ${n.build.sourcemap?U.green("ok"):U.red("invalid")}`))},async generateBundle(e,t){for(let e in a.installPluginContext(this),a.setupRollupChunks(t),t){let n=t[e],[i,o]=function(e,t){var n;if(n=e.fileName,".js"===r.extname(n)){let r=e.fileName+".map";return r in t?[!0,r]:[!0,void 0]}return[!1,void 0]}(n,t);if(i&&await a.addModule(n,o),!c.previousSourcemapOption&&i){if(o){Reflect.deleteProperty(t,o);continue}"chunk"===n.type&&Reflect.deleteProperty(n,"map")}}},async closeBundle(){e.summary&&!f&&t.info(e4(a.modules));let o=a.processModule();if(m){let t="fileName"in e?e.fileName:"stats",n=r.join(d,`${t}.${"json"===e.analyzerMode?"json":"html"}`);if("json"===e.analyzerMode)return W.writeFile(n,JSON.stringify(o,null,2),"utf8");let i=await er(o,{title:u,mode:e.defaultSizes||"stat"});if(W.writeFile(n,i,"utf8"),g.into(i),"static"===e.analyzerMode&&!e.openAnalyzer)return}if(h){let t=await er(o,{title:u,mode:e.defaultSizes||"stat"});g.into(t);let{setup:r,port:s}=await ei("analyzerPort"in e?"auto"===e.analyzerPort?0:e.analyzerPort:8888);r({title:u,mode:"stat",arena:g}),"openAnalyzer"in e&&!e.openAnalyzer||e0||function(e){let[t,r]=function(e){switch(e){case"linux":if(-1!==n.release().toLocaleLowerCase().indexOf("microsoft"))return["win32","cmd.exe"];return["linux","xdg-open"];case"win32":return["win32","cmd.exe"];case"darwin":return["darwin","open"];default:return[e,"xdg-open"]}}(n.platform());"win32"===t&&(e=["/c","start",'""'].concat(e=e.map(e=>e.replace(/[&^]/g,"^$&")))),i.spawn(r,e)}([`http://localhost:${s}`])}}}}exports.adapter=function(e){let t=["name","generateBundle","closeBundle","api"].reduce((t,r)=>(t[r]=e[r],t),{}),r=process.cwd(),{store:n}=t.api;return{...t,outputOptions(e){if(!n.hasSetSourcemapOption)return e.dir&&(r=e.dir),n.analyzerModule.workspaceRoot=es(r),"sourcemap"in e&&(n.previousSourcemapOption="boolean"==typeof e.sourcemap?e.sourcemap:"hidden"===e.sourcemap),"boolean"==typeof e.sourcemap&&e.sourcemap?e.sourcemap=!0:e.sourcemap="hidden",e}}},exports.analyzer=e5,exports.default=e5;
